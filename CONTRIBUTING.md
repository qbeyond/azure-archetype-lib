# Contribute

Thank you for contributing!

Please read this document and follow it to adhere to our standards.

## Testing

When you contribute to this repository, make sure that you check the [Tests](tests\README.md). Create or change tests as needed.

## Writing Policies

When writing policies, include an `Effect` parameter.

```json
//...
"parameters": {
    "effect": {
        "type": "string",
        "defaultValue": "Deny",
        "allowedValues": [
            "Audit",
            "Deny",
            "Disabled"
        ],
        "metadata": {
            "displayName": "Effect",
            "description": "The effect determines what happens when the policy rule is evaluated to match"
        }
    }
},
//...
// Other policy properties
//...
"policyRule": {
    "if": {
    // Rule conditions
    },
    "then": {
        "effect": "[[parameters('effect')]"
    }
}
```

### Policies for VMs

Policies applying to VMs should also target Scale Sets and Arc machines. 

Policies applying to VMs should target Linux & Windows machine in the same policy, if it is similar enough. Then there should be the following parameters to filter specific OS and/or types:

```json
"parameters": {
         "osTypeArc": {
             "type": "String",
             "metadata": {
                 "displayName": "OS type Arc machines included",
                 "description": "Filter Arc machines by osType. None excludes arc machines. All includes any Arc machine."
             },
             "defaultValue": "All",
             "allowedValues": [
               "All",
               "Windows",
               "Linux",
               "None"
           ]
         },
         "osOffers": {
             "type": "Array",
             "metadata": {
                "displayName": "OS offers included",
                 "description": "Include only offers of VMs and Scale sets like specified strings. Can contain * as wildcard. ['*'] includes any offer. Use an empty array [] to exclude VMs and scale sets."
             },
             "defaultValue": [
               "*"
             ]
         }
     }
```

You can use the following filter as a basic implementation:

```json

```

Do not filter by `Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType`, as it is an [autogenerated property](https://github.com/Azure/azure-policy#optional-or-auto-generated-resource-property-that-bypasses-policy-evaluation) and bypasses policy evaluation on creation.